\documentclass{beamer}
\usetheme{Madrid}

\usepackage{graphicx,hyperref,url}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows}
\usetikzlibrary{positioning}
%\usepackage[T1]{fontenc}
\usepackage{booktabs}
\usepackage{enumitem}
\setbeamercovered{transparent}

\setlistdepth{9}
\setlist[itemize,1]{label=$\bullet$}
\setlist[itemize,2]{label=$\bullet$}
\setlist[itemize,3]{label=$\bullet$}
\setlist[itemize,4]{label=$\bullet$}
\setlist[itemize,5]{label=$\bullet$}
\setlist[itemize,6]{label=$\bullet$}
\setlist[itemize,7]{label=$\bullet$}
\setlist[itemize,8]{label=$\bullet$}
\setlist[itemize,9]{label=$\bullet$}
\renewlist{itemize}{itemize}{9}

\setlist[enumerate,1]{label=$\arabic*.$}
\setlist[enumerate,2]{label=$\alph*.$}
\setlist[enumerate,3]{label=$\roman*.$}
\setlist[enumerate,4]{label=$\arabic*.$}
\setlist[enumerate,5]{label=$\alpha*$}
\setlist[enumerate,6]{label=$\roman*.$}
\setlist[enumerate,7]{label=$\arabic*.$}
\setlist[enumerate,8]{label=$\alph*.$}
\setlist[enumerate,9]{label=$\roman*.$}
\renewlist{enumerate}{enumerate}{9}

\AtBeginSection[]{
  \begin{frame}[noframenumbering]
  \vfill
  \centering
  \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
    \usebeamerfont{title}\insertsectionhead\par%
  \end{beamercolorbox}
  \vfill
  \end{frame}
}

\title[Verified Timely Dataflow]{Verified Timely Dataflow}

\author[Rafael Castro]{
  Rafael Castro G. Silva\\\medskip
  {\small \url{rafaelcgs10@gmail.com}}}

\date{18/05/2022}

\institute[UCPH]{
  Computer Science Department \\
  Copenhagen University}

\begin{document}

\begin{frame}
  \titlepage

\end{frame}

\begin{frame}[fragile]
  \frametitle{What is this PhD about?}
  \begin{itemize}
    \item Distributed Systems
          \begin{itemize}
            \item Stream processing frameworks
                  \begin{itemize}
                    \item Dataflow models
                          \begin{itemize}
                            \item Timely Dataflow
                          \end{itemize}
                  \end{itemize}
          \end{itemize}
    \item Formal Methods
          \begin{itemize}
            \item Verification using proof assistants
                  \begin{itemize}
                    \item Isabelle proofs
                          \begin{itemize}
                            \item Verified and executable code
                          \end{itemize}
                  \end{itemize}
          \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Contents}
  \begin{itemize}
    \item Timely Dataflow
    \item Progress Tracking
    \item Verified Progress Tracking
    \item Verified Timely Dataflow
    \item Questions, comments and suggestions
  \end{itemize}
\end{frame}

\section{Timely Dataflow}

\begin{frame}
  \frametitle{Dataflow}
  \begin{itemize}
    \item A Dataflow program is a DAG (Directed Acyclic Graph)
          \pause
    \item Edges are communication channels and nodes are operators
          \pause
    \item Examples of frameworks: Apache Spark, Apache Flink and Google Cloud Dataflow
          \pause
    \item Stream and batch processing
          \pause
    \item Automatic data parallelism
          \pause
    \item No support for cycles (iteration)
  \end{itemize}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow}
  \begin{center}
    \input{example_1_frame_1}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow}
  \begin{center}
    \input{example_1_frame_2}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow}
  \begin{center}
    \input{example_1_frame_3}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow}
  \begin{center}
    \input{example_1_frame_4}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow}
  \begin{center}
    \input{example_1_frame_5}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow}
  \begin{center}
    \input{example_1_frame_6}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow}
  \begin{center}
    \input{example_1_frame_7}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow}
  \begin{center}
    \input{example_1_frame_8}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow}
  \begin{center}
    \input{example_1_frame_9}
  \end{center}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Example of a conventional Dataflow with a cycle}
  \begin{center}
    \input{example_2_1_frame_1}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow with a cycle}
  \begin{center}
    \input{example_2_1_frame_2}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow with a cycle}
  \begin{center}
    \input{example_2_1_frame_3}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow with a cycle}
  \begin{center}
    \input{example_2_1_frame_4}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow with a cycle}
  \begin{center}
    \input{example_2_1_frame_5}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow with a cycle}
  \begin{center}
    \input{example_2_1_frame_6}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow with a cycle}
  \begin{center}
    \input{example_2_1_frame_7}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow with a cycle}
  \begin{center}
    \input{example_2_1_frame_8}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Example of a conventional Dataflow with a cycle}
  \begin{center}
    \input{example_2_1_frame_9}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Timely Dataflow}
  \begin{itemize}
    \item Iterative computation (cycles)
          \pause
    \item Reports on the presence of data instead of the absence
          \pause
    \item Two implementations: Rust and C\# (Naiad)
  \end{itemize}
  \pause
  \begin{figure}
    \includegraphics[width=\textwidth]{naiad.jpg}
  \end{figure}
\end{frame}

\section{Progress Tracking}

\begin{frame}
  \frametitle{Progress Tracking Protocol}
  \begin{itemize}
    \item Two core components: Local Propagation and Distributed Exchange
          \begin{itemize}
            \item Local: localy compute the frontiers
                  \begin{itemize}
                    \item \textit{A frontier is a lower bound on the timestamps that may appear at the operator instance inputs}
                  \end{itemize}
            \item Exchange the timestamps between workers
          \end{itemize}
          \pause
    \item For every worker and for every location of the graph a conservative approximation of which timestamps may still arrive (a.ka. frontier)
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_1}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_2}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_3}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_4}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_5}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_6}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_7}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_8}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_9}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_10}
  \end{center}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Local Propagation Example}
  \begin{center}
    \input{example_3_frame_11}
  \end{center}
\end{frame}

\section{Verified Progress Tracking}

\begin{frame}
  \frametitle{Verified Progress Tracking Protocol}
  \begin{itemize}
    \item Exchange Protocol Verification:
          \begin{itemize}
            \item Presented by Abadi et al. in TLA+
            \item Refined version in Isabelle by M. Brun, S. Decova, A. Lattuada, and D. Traytel
            \item \textbf{Safety}: If a timestamp is vacant in one worker (now), then it is vacant for the global system state (now and forever)
          \end{itemize}
          \pause
    \item Local Propagation Verification:
          \begin{itemize}
            \item In Isabelle by M. Brun, S. Decova, A. Lattuada, and D. Traytel
            \item \textbf{Safety}:
                  \begin{itemize}
                    \item Lets call \textit{P} the set of timestamps observed in a location (node)
                    \item Lets call \textit{W} the set of timestamps not propagated yet of a location
                    \item Then safety is: For a given \textit{t} present in some \textit{P}, if \textit{t} is no longer present in any \textit{W}, then all frontiers are updated in respect to \textit{t}
                  \end{itemize}
          \end{itemize}
  \end{itemize}
\end{frame}

\section{Verified Timely Dataflow}

\begin{frame}
  \frametitle{Verified Timely Dataflow}
  \begin{block}{General goal}
    Contribute to an ongoing formalization effort using the Isabelle proof assistant towards the first formally verified system for the analysis of big data.
  \end{block}
  \pause
  \begin{block}{Specific goals}
    \begin{enumerate}
      \item Termination of the propagation protocol
      \item Executable Progress Tracking Protocol
      \item Data plane
      \item Scopes
      \item DSL
      \item Experiments
    \end{enumerate}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{Termination of the propagation protocol}
  \begin{itemize}
    \item \textit{propagate} is a relation between two system configurations and also parameterized by location and a timestamp:
          \begin{itemize}
            \item Propagating the timestamp \textit{t} in location \textit{loc} the configuration \textit{c1} turns into \textit{c2}
          \end{itemize}
    \item We aim to show that it's impossible cannot propagate forever
    \item We've already managed to show that for a fixed timestamp it cannot be propagate forever
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Executable Progress Tracking Protocol}
  \begin{itemize}
    \item The propagation protocol is already executable (Sara Decova's master thesis)
    \item The Exchange protocol also should be made executable
          \begin{item}
            \item Prove that the functions are consistent with the relational counterparties
          \end{item}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Data plane}
  \begin{itemize}
    \item Nodes must be real operators: they execute user defined functions over the data
    \item Edges must be channels: they are streams with push and pull API
          \begin{itemize}
            \item Must exchange data between different workers
          \end{itemize}
    \item Low level operator constructors (define operators for any amount of inputs and outputs)
    \item A set of generally useful built-in operators: filter, filter partition, count, aggregate, etc
    \item The Safety properties again!
    \item Executable from the start
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Scopes}
  \begin{itemize}
    \item Hierarchal dataflows: an operator can also be a sub-dataflow inside of a dataflow
    \item This is designed as scopes
          \begin{itemize}
            \item An additional timestamp dimension
          \end{itemize}
    \item Another propagation (upwards and downwards)
    \item The Safety properties once again!
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{DSL}
  \begin{itemize}
    \item Writting dataflow programs in Isabelle is quite inconvenient
    \item A suitable domain-specific language (DSL)
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Experiments}
  \begin{enumerate}
    \item How faithful is the verified model to the Rust implementation?
    \item Are there any bugs in the Rust implementation not present in the verified code?
    \item How does the performance of the verified code compares to the Rust implementation?
  \end{enumerate}
\end{frame}

\section{Questions, comments and suggestions}

\end{document}
