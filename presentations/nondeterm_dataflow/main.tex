\documentclass[fleqn,aspectratio=169,10pt]{beamer}
\usetheme{Madrid}
\usepackage[T1]{fontenc}
\include{defs}

\usepackage{wasysym}
\usepackage{fancybox,graphicx,hyperref,url}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows}
\usetikzlibrary{positioning}
\usepackage{booktabs}
\usepackage{enumitem}

\usepackage{listings}
\usepackage{pdfpages}
\usepackage{lstautogobble}

\usepackage[listings,skins,breakable,xparse,most,raster]{tcolorbox}
\tcbuselibrary{theorems}
\tcbset{highlight math/.append style={boxrule=0pt,
                                      frame hidden,
                                      colback=yellow!40!white,
                                      sharp corners}}

\usepackage{xpatch}

\usepackage{realboxes}
\usetikzlibrary{fit}
\usetikzlibrary{shadings}
\usetikzlibrary{shapes.arrows,shadows.blur}

\pgfdeclarefunctionalshading{Hermite-Gaussian modes}{\pgfpoint{-25bp}{-25bp}}{\pgfpoint{25bp}{25bp}}{}{
    10 atan sin 1000 mul cos 1 add
    exch
    10 atan sin 1000 mul cos 1 add
    mul 4 div
    dup dup
}

\makeatletter
\xpretocmd\lstinline{\Colorbox{yellow!10!white}\bgroup\appto\lst@DeInit{\egroup}}{}{}
\makeatother

\definecolor{my_red}{RGB}{128, 0, 0}

\lstset{captionpos=b}
\lstset{numberbychapter=false}
\lstset{autogobble}
% \lstset{breaklines=true}

\usepackage{tikz}
\usepackage{subcaption}
\usetikzlibrary{calc, chains, decorations.pathmorphing}
\usetikzlibrary{shapes,arrows,backgrounds}
\usetikzlibrary{positioning,fit,shapes.geometric,shapes}

\setbeamercovered{transparent}

\setlistdepth{9}
\setlist[itemize,1]{label=$\bullet$}
\setlist[itemize,2]{label=$\bullet$}
\setlist[itemize,3]{label=$\bullet$}
\setlist[itemize,4]{label=$\bullet$}
\setlist[itemize,5]{label=$\bullet$}
\setlist[itemize,6]{label=$\bullet$}
\setlist[itemize,7]{label=$\bullet$}
\setlist[itemize,8]{label=$\bullet$}
\setlist[itemize,9]{label=$\bullet$}
\renewlist{itemize}{itemize}{9}

\setlist[enumerate,1]{label=$\arabic*.$}
\setlist[enumerate,2]{label=$\alph*.$}
\setlist[enumerate,3]{label=$\roman*.$}
\setlist[enumerate,4]{label=$\arabic*.$}
\setlist[enumerate,5]{label=$\alpha*$}
\setlist[enumerate,6]{label=$\roman*.$}
\setlist[enumerate,7]{label=$\arabic*.$}
\setlist[enumerate,8]{label=$\alph*.$}
\setlist[enumerate,9]{label=$\roman*.$}
\renewlist{enumerate}{enumerate}{9}

\AtBeginSection[]{
  \begin{frame}[noframenumbering]
    \vfill
    \centering
    \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
      \usebeamerfont{title}\insertsectionhead\par%
    \end{beamercolorbox}
    \vfill
  \end{frame}
}

\title[Nondeterministic Asynchronous Dataflow in Isabelle/HOL]{Nondeterministic Asynchronous Dataflow in Isabelle/HOL}

\author[Rafael, Laouen and Dmitriy]{
  \underline{Rafael Castro G. Silva}, Laouen Fernet and  Dmitriy Traytel\\\medskip
  }
% {\small \url{rasi@di.ku.dk}}

\date{14/05/2025}

% change title (done)
% (co)datatypes -> codatatypes (done)
% while_option from HOL library (done)
% coindtive principle -> coinduction principle (done)
% remove next step slide, andd as a bullet (done)
% explain slice in more detail (done)
% mention selectors in llist slide, drop lmap, drop lset (done)
% move count operator example to slide that introduce op type (done)
% modeling lazy list processors which do not care about time (done)
% reduce Corecursion is like recursion line (done)
% why partial order? mention timely dataflow (done)
% explain what incremental, and set expectation for example (done)
% move arrows (done)
% Change push to out, done to out (done)
% put star footnote on op type saying it is simplified compare to the paper, also in the composition lemma (done)
% write the lapp lemma about lfinite (done)
% show coinduction principle for llist (done)
% add link llist afp (done)
% on produce slide, metion lshift as friend (point to freinds with benefits paper) (done)
% justify the compositional reasoning with lines of code for each building block (done)
% slide about tecnicques used, coinduction principles, friends, reasoning up to friends, generalization using skip_op, combining coinduction and induction, coinduction up to congruence for coinductive predicates, say our paper is more detailed in these topics
%
% add definition of batch_op, and all 4 properties

\institute[UCPH]{
  Department of Computer Science \\
  University of Copenhagen}

\begin{document}
\setbeamercovered{invisible}
% \setbeamercovered{dynamic}

\begin{frame}
  \titlepage
\end{frame}

\section{Motivation}

\begin{frame}[fragile]
  \frametitle{Motivation}
  \begin{block}{Context:}
  \begin{itemize}
    \item Stream Processing: programs that compute (possibly) unbounded sequences of data (streams)
    \item A common problem in the industry
    \item Frameworks: Apache Flink, Google Cloud Dataflow, and Timely Dataflow
          \begin{figure}
            \centering
            \includegraphics[scale=0.1]{all}
          \end{figure}
    \item Why use frameworks?
          \begin{itemize}
            \item Highly Parallel
            \item Low latency (output as soon as possible)
            \item Incremental computing (re-uses previous computations)
          \end{itemize}
  \end{itemize}
  \pause
  \end{block}
  \begin{block}{Our goal:}
    Mechanically Verify Timely Dataflow algorithms
  \end{block}
\end{frame}

\section{A Good Foundation}

\begin{frame}[fragile]
  \frametitle{A Good Foundation}
  \begin{columns}
    \begin{column}{.35\textwidth}
      \begin{figure}
        \centering
        \includegraphics[width=1\textwidth]{network.png}
      \end{figure}
    \end{column}
    \begin{column}{.65\textwidth}
      \begin{itemize}
        \item Nondeterministic Asynchronous Dataflow
              \begin{itemize}
                \pause
                \item Dataflow: Directed graph of interconnected operators
                \pause
                \item Asynchronous:
                      \begin{itemize}
                        \item Operators execute independently:\\ processes without an orchestrator
                        \item Operators can freely communicate with the network (read/write); do silent computation steps
                        \item Networks are unbounded FIFO queues
                      \end{itemize}
                \pause
                \item Nondeterministic:
                      \begin{itemize}
                        \item Operators can make nondeterministic choices
                      \end{itemize}
              \end{itemize}
      \end{itemize}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{The Algebra for Nondeterministic Asynchronous Dataflow}
  \begin{columns}
    \begin{column}{.6\textwidth}
      \begin{itemize}
        \item Bergstra et al. presents an algebra for Nondeterministic Asynchronous Dataflow
        \item Primitives:\\
              sequential and parallel composition; feedback loop...
        \item 52 axioms
        \item A process calculus instance
      \end{itemize}
    \end{column}
    \begin{column}{.4\textwidth}
      \begin{figure}
        \centering
        \shadowbox{\includegraphics[width=0.9\textwidth]{Bergstra.png}}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Main Contributions}
  \begin{itemize}
    \item A Isabelle/HOL instance of Nondeterministic Asynchronous Dataflow
          \begin{itemize}
            \item Operators as a shallow embedding as codatatypes
            \item 51 axioms proved
          \end{itemize}
    \item Executable via code extraction to Haskell
  \end{itemize}
\end{frame}

\section{Isabelle/HOL Preliminaries}

\begin{frame}[fragile]
  \frametitle{Isabelle/HOL}
  \begin{itemize}
    \item Classical higher-order logic (HOL):\\ Simple Typed Lambda Calculus + axiom of choice + axiom of infinity + rank-1 polymorphism
          \pause
    \item Isabelle: A generic proof assistant
          \begin{overlayarea}{\textwidth}{.3\textheight}
            \centering
            \begin{figure}
              \centering
              \includegraphics[scale=0.15]{isabelle}
            \end{figure}
          \end{overlayarea}
    \item Isabelle/HOL: Isabelle's flavor of HOL
  \end{itemize}
  \pause
    \begin{block}{Why Isabelle/HOL?}
      \begin{itemize}
        \item Codatatypes: (possibly) infinite data structures (e.g., lazy lists, streams)
        \item Corecursion: always eventually produces some codatatype constructor
        \item Coinductive predicate: infinite number of introduction rule applications
        \item Coinduction: reason about coinductive predicates
      \end{itemize}
  \end{block}

\end{frame}

\section{Operators as a Codatatype}

\begin{frame}[fragile]
  \frametitle{Operators}
  \vspace*{-2ex}
  \begin{tcolorbox}[enhanced,title=Operators in Isabelle/HOL,colback=yellow!30]
    \vspace*{-3ex}
    \hspace*{-5ex}
    \begin{align*}
      &   \cmd{codatatype}\ (\const{inputs}\!: \tvar{i}, \const{outputs}\!: \tvar{o}, \tvar{d})\ \type{op} =\\
      &   \more \const{Read}\ \tvar{i}\ (\tvar{d} \Fun (\tvar{i}, \tvar{o}, \tvar{d})\ \type{op})\ |\ \const{Write}\ ((\tvar{i}, \tvar{o}, \tvar{d})\ \type{op})\ \tvar{o}\ \tvar{d}\\
      &   \more \const{Silent}\ (\tvar{i}, \tvar{o}, \tvar{d})\ \type{op}\ |\ \const{Choice}\ ((\tvar{i}, \tvar{o}, \tvar{d})\ \type{op})\ \type{cset}
    \end{align*}
  \end{tcolorbox}

  \begin{columns}
    \begin{column}{.3\textwidth}
      \pause
      \begin{itemize}
        \item Type parameters: \\
              inputs/output ports; data
        \item Operator's actions
        \item inputs/outputs: \\
              Sets of used ports
        \item Possibly infinite trees
      \end{itemize}
    \end{column}
    \begin{column}{.22\textwidth}
      \pause
      \begin{tcolorbox}[enhanced,title=Uncommunicative operators,colback=yellow!30]
        \vspace*{-5ex}
        \hspace*{-8ex}
        \begin{tabular}{l l l}
          \hspace*{-4ex}
          \isa{
          & \more \EndOp = \const{Choice}\ \{\}_c
            }&
          \vspace*{-5ex}
          \\
          \hspace*{-4ex}
          \isa{
          & \more \SilentOp = \const{Silent}\ \SilentOp
            }&
          \vspace*{-5ex}
          \\
          \hspace*{-4ex}
          \isa{
          & \more \SpinOp = \const{Choice}\ \{\SpinOp\}_c
            }
        \end{tabular}
        \vspace*{-1ex}
      \end{tcolorbox}
    \end{column}
    \begin{column}{.48\textwidth}
      \pause
      \begin{tcolorbox}[enhanced,title=More examples,colback=yellow!30]
        \vspace*{-5ex}
        \hspace*{-8ex}
        \begin{tabular}{l l l}
          \hspace*{-2ex}
          \isa{
          \const{ex1} = \const{Choice}\ \{\const{Write}\ \const{ex1}\ 1\ 42, \EndOp\}_c
            }&
          \vspace*{-4ex}
          \\
          \hspace*{-2ex}
          \isa{
          \const{ex2} = \const{Choice}\ \{\const{Write}\ \const{ex2}\ 1\ 42, \const{ex2}\}_c
          }
          \vspace*{-4ex}
          \\
          \hspace*{-2ex}
          \isa{
          \const{ex3} = \const{Choice}\ \{\const{Write}\ \const{ex3}\ 1\ 42, \const{Silent}\ \const{ex3}\}_c
          }
        \end{tabular}
        \vspace*{-1ex}
      \end{tcolorbox}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Operators Equivalences: Motivation}
  \begin{block}{An ideal equivalence relation}
    \begin{itemize}
      \item Only equate operators that \textbf{behave} the same
      \item Useful reasoning principle
    \end{itemize}
  \end{block}
  \pause
  \begin{itemize}

          \begin{columns}
            \begin{column}{.42\textwidth}
              \item Milner's approach: Weak Bisimilarity
            \end{column}
            \begin{column}{.1\textwidth}
              \begin{figure}
                \includegraphics[width=1\textwidth]{milner.jpg}
              \end{figure}
            \end{column}
            \begin{column}{.1\textwidth}
                \includegraphics[width=1\textwidth]{book.jpg}
            \end{column}
            \begin{column}{.1\textwidth}
            \end{column}
          \end{columns}
          \item Based on labeled transition systems (LTS)
          \item Labels (actions): Read, Write, Silent ($\tau$)
  \end{itemize}
  % \begin{block}{Intuition}
  %   \footnotesize{Two operators are bisimilar if their corresponding transition systems can mutually simulate each otherâ€™s transitions.}
  % \end{block}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Operators Equivalences: Label Transition System}
  \begin{tcolorbox}[enhanced,title=Label Transition System,colback=yellow!30]
    \vspace*{-3ex}
    \hspace*{-5ex}
    \begin{align*}
        &    \cmd{datatype}\ (\tvar{i}, \tvar{o}, \tvar{d})\ \type{IO} = \const{Inp}\ \tvar{i}\ \tvar{d}\ |\ \const{Out}\ \tvar{o}\ \tvar{d}\ |\ \const{Tau}
        \\[\jot]
        & \cmd{inductive}\ \const{step}\ \cmd{where}\\
        & \more \const{step}\ (\const{Inp}\ \var{p}\ \var{x})\ (\const{Read}\ \var{p}\ \var{f})\ (\var{f}\ \var{x}) \\
        & \bmore \const{step}\ (\const{Out}\ \var{q}\ \var{x})\ (\const{Write}\ \var{op}\ \var{q}\ \var{x})\ \var{op} \\
        & \bmore \const{step}\ \const{Tau}\ (\const{Silent}\ \var{op})\ \var{op} \\
        & \bmore \var{op} \in_c \var{ops} \implies \const{step}\ \var{io}\ \var{op}\ \var{op}' \implies \const{step}\ \var{io}\ (\const{Choice}\ \var{ops})\ \var{op}'
    \end{align*}
  \end{tcolorbox}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Operators Equivalences: Weak Bisimilarity}
    \vspace*{-2ex}
  \begin{tcolorbox}[enhanced,title=Weakly Simulates,colback=yellow!30]
    \vspace*{-4ex}
    \hspace*{-5ex}
    \begin{align*}
     & \const{estep}\ \const{Tau} = (\const{step}\ \const{Tau})^{==} \\
     & \const{estep}\ \var{io} = \const{step}\ \var{io}
    \\
    &  \const{wstep}\ \var{io} = (\const{step}\ \const{Tau})^{**}\ \const{OO}\ (\const{estep}\ \var{io})\ \const{OO}\ (\const{step}\ \const{Tau})^{**}
    \\
    & \const{wsim}\ \var{R}\ \var{op}_1\ \var{op}_2 = (\forall \var{io}\; \var{op}'_1.\ \const{step}\ \var{io}\ \var{op}_1\ \var{op}'_1 \Implies (\exists \var{op}'_2.\ \const{wstep}\ \var{io}\ \var{op}_2\ \var{op}'_2 \land \var{R}\ \var{op}'_1\ \var{op}'_2))
    \end{align*}
    \vspace*{-5ex}
  \end{tcolorbox}
  \vspace*{-1ex}
  \begin{itemize}
    \item A Relation \isabelleinline{\var{R}} is a \emph{weak simulation} if \isabelleinline{\forall \var{op}_1\; \var{op}_2.\ \var{R}\ \var{op}_1\ \var{op}_2 \Implies \const{wsim}\ \var{R}\ \var{op}_1\ \var{op}_2}.
  \end{itemize}
    \vspace*{-1.3ex}
  \pause
  \begin{tcolorbox}[enhanced,title=Weak Bisimilarity,colback=yellow!30]
    \vspace*{-3ex}
    \hspace*{-5ex}
    \begin{align*}
     & \cmd{coinductive}\ \const{wbisim}\ (\cmd{infix} \wbisim{}{} 40)\ \cmd{where}\\
     & \more \const{wsim}\ (\approx)\ \var{op}_1\ \var{op}_2 \implies \const{wsim}\ (\approx)\ \var{op}_2\ \var{op}_1 \implies \wbisim{\var{op}_1}{\var{op}_2}
    \end{align*}
    \vspace*{-5ex}
  \end{tcolorbox}
  \vspace*{-1ex}
  \begin{itemize}
    \item \isabelleinline{\var{R}} is a \emph{weak bisimulation} when both \isabelleinline{\var{R}} and its converse \isabelleinline{\var{R}^{\const{-1}}} are weak simulations. \\
          Weak bisimilarity is the largest weak bisimulation.
  \end{itemize}

  \pause
  \begin{itemize}
    \item $\approx$ has a useful coinduction principle
    \item $\EndOp \approx \SpinOp \approx \SilentOp$ and $\const{ex1} \approx \const{ex2} \approx \const{ex3}$
  \end{itemize}
\end{frame}

\section{Asynchronous Dataflow Operators}

\begin{frame}[fragile]
  \frametitle{Auxiliary definitions}
      \pause
  \begin{tcbraster}[raster columns=2, raster equal height]
    \begin{tcolorbox}[enhanced,title=Buffer functions,colback=yellow!30]
      \vspace*{-4ex}
      \begin{align*}
        & \hspace*{-6ex} \const{BHD}\ \var{p}\ \var{buf} = \const{hd}\ (\var{buf}\ \var{p})
        \\
        & \hspace*{-6ex} \const{BTL}\ \var{p}\ \var{buf} = \var{buf}(\var{p} := \const{tl}\ (\var{buf}\ \var{p}))
        \\
        & \hspace*{-6ex} \const{BENQ}\ \var{p}\ \var{x}\ \var{buf} = \var{buf}(\var{p} := \var{buf}\ \var{p}\ \const{@}\ [\var{x}])
        \\
        & \hspace*{-6ex} \BulkBenq{\var{buf}_1}{\var{buf}_2} = (\lambda \var{p}.\ \var{buf}_2\ \var{p}\ \const{@}\ \var{buf}_1\ \var{p})
      \end{align*}
      \vspace*{-5ex}
    \end{tcolorbox}
      \pause
    \begin{tcolorbox}[enhanced,title=choices function,colback=yellow!30]
      \vspace*{-4ex}
      \hspace*{-5ex}
      \begin{align*}
        & \hspace*{-6ex} \const{choices}\ \SpinOp = \Emptyset \\
        & \hspace*{-6ex} \const{Silent}\ \var{op}' \in_c \const{choices}\ \var{op} \Iff \const{step}\ \const{Tau}\ \var{op}\ \var{op}' \\
        & \hspace*{-6ex} \const{choices}\; (\const{Choice}\ \var{ops}) = \bigcup {}_c \ (\const{choices}\ \Image_c\ \var{ops})
      \end{align*}
      \vspace*{-5ex}
    \end{tcolorbox}
  \end{tcbraster}
      \pause
      \begin{tcolorbox}[enhanced,title=Mapping ports functions,colback=yellow!30,]
        \vspace*{-4ex}
        \begin{align*}
          & \hspace*{-6ex} \const{map\_op} \oftype \type{(\tvar{i}_1 \Fun \tvar{i}_2) \Fun (\tvar{o}_1 \Fun \tvar{o}_2) \Fun (\tvar{i}_1, \tvar{o}_1, \tvar{d})\ \type{op} \Fun (\tvar{i}_2, \tvar{o}_2, \tvar{d})\ \type{op}} \\
          & \hspace*{-6ex} \const{projl}\ \oftype \type{(\tvar{a} + \tvar{b}) \Fun \tvar{a}} \\
          & \hspace*{-6ex} \const{projr}\ \oftype \type{(\tvar{a} + \tvar{b}) \Fun \tvar{b}} \\
          & \hspace*{-6ex} \reassoc\ \oftype \type{(\tvar{a} + \tvar{b}) + \tvar{c} \Fun \tvar{a} + \tvar{b} + \tvar{c}} \\
          & \hspace*{-6ex} \assoc\ \oftype \type{\tvar{a} + \tvar{b} + \tvar{c} \Fun (\tvar{a} + \tvar{b}) + \tvar{c} }
        \end{align*}
        \vspace*{-5ex}
      \end{tcolorbox}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Identity}
  \begin{tcolorbox}[enhanced,title=Equation of the identity operator,colback=yellow!30]
    \vspace*{-3ex}
    \hspace*{-5ex}
    \begin{align*}
      & \const{id_op}\ \var{buf} = \const{Choice}
      \\
      & \only<2->{(((\lambda \var{p}.\ \const{Read}\ \var{p}\ (\lambda \var{x}.\ \const{id_op}\ (\const{BENQ}\ \var{p}\ \var{x}\ \var{buf})))\ \Image_c \ \Univ_c)\ }
      \\
      &\Union_c
      \\
      &\only<3->{\phantom{(}((\lambda \var{p}.\ \const{Write}\ (\const{id_op}\ (\const{BTL}\ \var{p}\ \var{buf}))\ \var{p}\ (\const{BHD}\ \var{p}\ \var{buf}))\ \Image_c \ \{\var{p} \in_c \Univ_c \mid \var{buf}\ \var{p} \neq []\}))}
    \end{align*}
  \end{tcolorbox}

  \only<2->{
    \begin{itemize}
            \only<2->{\item $\Univ_c$ is the set of usable ports provide by its type}
            \only<4->{\item Stream delayer!}
    \end{itemize}
  }

  \only<5->{
  \begin{tcolorbox}[enhanced,title=Identity operator with an empty buffer,colback=yellow!30]
    \vspace*{-3ex}
    \hspace*{-5ex}
    \begin{align*}
      \IdOp = \const{id_op}\ (\lambda \_.\ [])
    \end{align*}
  \end{tcolorbox}
  }
\end{frame}

\begin{frame}[fragile]
  \frametitle{Composition: Preliminaries}
  \vspace*{-2ex}
  \begin{tcolorbox}[enhanced,title=Composition operator type,colback=yellow!30]
    \vspace*{-4ex}
    \hspace*{-8ex}
    \begin{align*}
      & \hspace*{-6ex} \const{comp_op}\ \oftype \type{(\tvar{o}_1 \Fun \tvar{i}_2 \ \type{option}) \Fun (\tvar{i}_2 \Fun \tvar{d}\ list) \Fun (\tvar{i}_1, \tvar{o}_1, \tvar{d})\ \type{op} \Fun (\tvar{i}_2, \tvar{o}_2, \tvar{d})\ \type{op} \Fun} \\
      & \hspace*{6.5ex} \type{(\tvar{i}_1 + \tvar{i}_2, \tvar{o}_1 + \tvar{o}_2, \tvar{d})\ \type{op}}
    \end{align*}
    \vspace*{-5ex}
  \end{tcolorbox}
  \pause

  \begin{tcolorbox}[enhanced,title=Sequential and parallel composition,colback=yellow!30]
    \vspace*{-4ex}
    \hspace*{-8ex}
    \begin{align*}
      & \Pcomp{\var{op}_1}{\var{op}_2} = \const{comp_op}\ (\lambda \_.\ \const{None})\ (\lambda \_.\ [])\ \var{op}_1\ \var{op}_2 \\
      & \Scomp{\var{op}_1}{\var{op}_2} = \const{map_op}\ \const{projl}\ \const{projr}\ (\const{comp_op}\ \const{Some}\ (\lambda \_.\ [])\ \var{op}_1\ \var{op}_2)
    \end{align*}
    \vspace*{-5ex}
  \end{tcolorbox}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Composition: equation}
  \vspace*{-2ex}
  \begin{tcolorbox}[enhanced,title=Composition operator,colback=yellow!30]
    \vspace*{-4ex}
    \hspace*{-8ex}
    \begin{align*}
     &\visible<1->{\const{comp_op}\ \var{wire}\ \var{buf}\ \var{op}_1\ \var{op}_2 =} \visible<2->{\const{Choice}\ } \visible<4->{(((\lambda \var{op}.\ \syntax{case}\ \var{op}\ \syntax{of}}\\
     &\visible<4->{\more \const{Read}\ \var{p}\ \var{f}\ \Fun \const{Read}\ (\const{Inl}\ \var{p})\ (\lambda x.\ \const{comp_op}\ \var{wire}\ \var{buf}\ (\var{f}\ \var{x})\ \var{op}_2)}\\
     &\visible<5->{\bmore \const{Write}\ \var{op}\ \var{p}\ \var{x} \Fun (\syntax{case}\ \var{wire}\ \var{p}\ \syntax{of}}\\
     &\visible<5->{\more \more \const{None} \Fun \const{Write}\ (\const{comp_op}\ \var{wire}\ \var{buf}\ \var{op}\ \var{op}_2)\ (\const{Inl}\ \var{p})\ \var{x}}\\
     &\visible<5->{\more \bmore \const{Some}\ \var{q} \Fun \const{Silent}\ (\const{comp_op}\ \var{wire}\ (\const{BENQ}\ \var{q}\ \var{x}\ \var{buf})\ \var{op}\ \var{op}_2))}\\
     &\visible<6->{\bmore \const{Silent}\ \var{op} \Fun \const{Silent}\ (\const{comp_op}\ \var{wire}\ \var{buf}\ \var{op}\ \var{op}_2))} \ \visible<3->{\Image_c \ \const{choices}\ \var{op}_1)} \ \visible<2->{\Union_c}\\
     &\visible<9->{\phantom{(}((\lambda \var{op}.\ \syntax{case}\ \var{op}\ \syntax{of}}\\
     &\visible<10->{\more \const{Read}\ \var{p}\ \var{f} \Fun \syntax{if}\ \var{p} \in \const{ran}\ \var{wire}}\\
     &\visible<10->{\more \more \syntax{then}\ \const{Silent}\ (\const{comp_op}\ \var{wire}\ (\const{BTL}\ \var{p}\ \var{buf})\ \var{op}_1\ (\var{f}\ (\const{BHD}\ \var{p}\ \var{buf})))}\\
     &\visible<10->{\more \more \syntax{else}\ \const{Read}\ (\const{Inr}\ \var{p})\ (\lambda \var{x}.\ \const{comp_op}\ \var{wire}\ \var{buf}\ \var{op}_1\ (\var{f}\ \var{x}))}\\
     &\visible<9->{\bmore \const{Write}\ \var{op}\ \var{p}\ \var{x} \Fun \const{Write}\ (\const{comp_op}\ \var{wire}\ \var{buf}\ \var{op}_1\ \var{op})\ (\const{Inr}\ \var{p})\ \var{x}}\\
     &\visible<11->{\bmore \const{Silent}\ \var{op} \Fun \const{Silent}\ (\const{comp_op}\ \var{wire}\ \var{buf}\ \var{op}_1\ \var{op}))} \ \visible<8->{\Image_c \ \const{sound_reads}\ \var{wire}\ \var{buf}\ } \visible<7->{(\const{choices}\ \var{op}_2)))}
    \end{align*}
    \vspace*{-5ex}
  \end{tcolorbox}

\end{frame}

\begin{frame}[fragile]
  \frametitle{Asynchronous Dataflow Operators}
  \begin{itemize}
    \item foo
  \end{itemize}
\end{frame}

\section{Asynchronous Dataflow Properties}
\begin{frame}[fragile]
  \frametitle{Basic network algebra properties}
  \begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{table_1.png}
  \end{figure}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Basic network algebra properties}
  \begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{table_1_1.png}
  \end{figure}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Basic network algebra properties}
  \begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{table_1_2.png}
  \end{figure}
\end{frame}

\begin{frame}[fragile, noframenumbering]
  \frametitle{Basic network algebra properties}
  \begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{table_1_3.png}
  \end{figure}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Properties of equality test, merge, copy, split, source and sink operators}
  \begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{table_1_3.png}
  \end{figure}
\end{frame}

\begin{frame}[fragile]
  \frametitle{A10}
  \begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{table_1_3.png}
  \end{figure}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Well-Behaved Operators}
  \begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{table_1_3.png}
  \end{figure}
\end{frame}

\section{Related Work}

\begin{frame}[fragile]
  \frametitle{Related Work}
  \begin{itemize}
    \item A Isabelle/HOL instance of Nondeterministic Asynchronous Dataflow
          \begin{itemize}
            \item Operators as a shallow embedding as codatatypes
            \item 51 axioms proved
          \end{itemize}
    \item Executable via code extraction to Haskell
  \end{itemize}
\end{frame}

\section{Conclusion}
\begin{frame}
  \frametitle{Conclusion}
  \begin{itemize}
    \item Isabelle/HOL has a good tool set to formalize and reason about stream processing:
          \begin{itemize}
            \item Codatatypes, coinductive predicates, corecursion with friends, reasoning up to friends (congruence),
                  \begin{itemize}
                    \item Coinduction up to congruence principle is automatically derived for codatatypes (but not for coinductive principles)
                  \end{itemize}
          \end{itemize}
    \item Next step: Feedback loop
  \end{itemize}
\end{frame}
            %             slide about tecnicques used, coinduction principles, friends, reasoning up to friends, generalization using skip_op, combining coinduction and induction, coinduction up to congruence for coinductive predicates, say our paper is more detailed in these topics

\section{Questions, comments and suggestions}

\end{document}
